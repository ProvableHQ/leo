program test_oob.aleo;

struct Optional__EsDmm5O6sv6:
    is_some as boolean;
    val as u32;

mapping vec__:
    key as u32.public;
    value as u32.public;

mapping vec__len__:
    key as boolean.public;
    value as u32.public;

function oob_get:
    async oob_get into r0;
    output r0 as test_oob.aleo/oob_get.future;

finalize oob_get:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    lt 0u32 r2 into r3;
    get.or_use vec__[0u32] 0u32 into r4;
    cast true r4 into r5 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r6 as Optional__EsDmm5O6sv6;
    ternary r3 r5.is_some r6.is_some into r7;
    ternary r3 r5.val r6.val into r8;
    cast r7 r8 into r9 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r10 as Optional__EsDmm5O6sv6;
    is.eq r9 r10 into r11;
    assert.eq r11 true;

function oob_set:
    async oob_set into r0;
    output r0 as test_oob.aleo/oob_set.future;

finalize oob_set:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    lt 0u32 r2 into r3;
    assert.eq r3 true;
    set 123u32 into vec__[0u32];

function oob_swap_remove:
    async oob_swap_remove into r0;
    output r0 as test_oob.aleo/oob_swap_remove.future;

finalize oob_swap_remove:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    lt 0u32 r2 into r3;
    assert.eq r3 true;
    get vec__[0u32] into r4;
    sub r2 1u32 into r5;
    get vec__[r5] into r6;
    set r6 into vec__[0u32];
    set r5 into vec__len__[false];

function oob_pop:
    async oob_pop into r0;
    output r0 as test_oob.aleo/oob_pop.future;

finalize oob_pop:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    gt r2 0u32 into r3;
    sub.w r2 1u32 into r4;
    ternary r3 r4 r2 into r5;
    set r5 into vec__len__[false];
    get.or_use vec__[r4] 0u32 into r6;
    cast true r6 into r7 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r8 as Optional__EsDmm5O6sv6;
    ternary r3 r7.is_some r8.is_some into r9;
    ternary r3 r7.val r8.val into r10;
    cast r9 r10 into r11 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r12 as Optional__EsDmm5O6sv6;
    is.eq r11 r12 into r13;
    assert.eq r13 true;

constructor:
    assert.eq edition 0u16;
verified: true
status: accepted
{
  "transitions": [
    {
      "id": "au19wslp8y66hzynzw020yrec6l32ygmsczrsvqk88v0ag3w2usl59s5zpk0u",
      "program": "test_oob.aleo",
      "function": "oob_get",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "622411233461466604139396124671651119442071811807111254065327053295602934574field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_get,\n  arguments: []\n}"
        }
      ],
      "tpk": "833089966493663202540766901708395611105536575105077867967829158700410259122group",
      "tcm": "7485521804063511942943091869142963682278936783888801180271256853511513183275field",
      "scm": "5144034662011761654275913773450695881448924606926464994556551176014719078281field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

verified: true
status: rejected
{
  "transitions": [
    {
      "id": "au1v5faaam9laemtchhh6nt5rgvnffeqhh3c304d89lwqdxu6gtlg9qemzxf4",
      "program": "test_oob.aleo",
      "function": "oob_set",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "5711066163060576566496980579899082121846565176191355684904482913467905894446field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_set,\n  arguments: []\n}"
        }
      ],
      "tpk": "4315764979869373587128262500752701904390940029841271397227749220529240410730group",
      "tcm": "4671295772625802923434679009752181396245515095345981368101432196282896048592field",
      "scm": "4616061811466973481392125130875109036076097460992490928651608874426784857340field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

verified: true
status: rejected
{
  "transitions": [
    {
      "id": "au1qt00c9pes8s40srgwyf7yjpagq0yaelztzqfhvyu38hakzxs8gfqahqgaw",
      "program": "test_oob.aleo",
      "function": "oob_swap_remove",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "6536916584823785446718025833378966958179344538444922006787769568609685746554field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_swap_remove,\n  arguments: []\n}"
        }
      ],
      "tpk": "4003777365250716037679522527684111283019073019094832134567862278702890583838group",
      "tcm": "3982027055641445658502699871692369682979352693243193890879332577222796699802field",
      "scm": "5747557037271996936066054472203512697488420686469597720496451459982319319624field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

verified: true
status: accepted
{
  "transitions": [
    {
      "id": "au1xlkqwgmxtdxy8hrpdn2eykthdm7j74pxwc0c2ky9ver8t735gsfqc2495r",
      "program": "test_oob.aleo",
      "function": "oob_pop",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "6995682591566362851520280766817064099411863567897414052779929702599852799080field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_pop,\n  arguments: []\n}"
        }
      ],
      "tpk": "4152100826390842181301910025383030070014538829986593409953886437452131536036group",
      "tcm": "1297520689930719799143439111715981644967272714967313747070039347460268476964field",
      "scm": "3332770526121947959267586771153448995016323132028448796237703881617586782206field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

