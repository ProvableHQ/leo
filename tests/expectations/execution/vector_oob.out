program test_oob.aleo;

struct Optional__EsDmm5O6sv6:
    is_some as boolean;
    val as u32;

mapping vec__:
    key as u32.public;
    value as u32.public;

mapping vec__len__:
    key as boolean.public;
    value as u32.public;

function oob_get:
    async oob_get into r0;
    output r0 as test_oob.aleo/oob_get.future;

finalize oob_get:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    lt 0u32 r2 into r3;
    get.or_use vec__[0u32] 0u32 into r4;
    cast true r4 into r5 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r6 as Optional__EsDmm5O6sv6;
    ternary r3 r5.is_some r6.is_some into r7;
    ternary r3 r5.val r6.val into r8;
    cast r7 r8 into r9 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r10 as Optional__EsDmm5O6sv6;
    is.eq r9 r10 into r11;
    assert.eq r11 true;

function oob_set:
    async oob_set into r0;
    output r0 as test_oob.aleo/oob_set.future;

finalize oob_set:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    lt 0u32 r2 into r3;
    assert.eq r3 true;
    set 123u32 into vec__[0u32];

function oob_swap_remove:
    async oob_swap_remove into r0;
    output r0 as test_oob.aleo/oob_swap_remove.future;

finalize oob_swap_remove:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    lt 0u32 r2 into r3;
    assert.eq r3 true;
    get vec__[0u32] into r4;
    sub r2 1u32 into r5;
    get vec__[r5] into r6;
    set r6 into vec__[0u32];
    set r5 into vec__len__[false];

function oob_pop:
    async oob_pop into r0;
    output r0 as test_oob.aleo/oob_pop.future;

finalize oob_pop:
    set 0u32 into vec__len__[false];
    get.or_use vec__len__[false] 0u32 into r0;
    is.eq r0 0u32 into r1;
    assert.eq r1 true;
    get.or_use vec__len__[false] 0u32 into r2;
    gt r2 0u32 into r3;
    sub.w r2 1u32 into r4;
    ternary r3 r4 r2 into r5;
    set r5 into vec__len__[false];
    get.or_use vec__[r4] 0u32 into r6;
    cast true r6 into r7 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r8 as Optional__EsDmm5O6sv6;
    ternary r3 r7.is_some r8.is_some into r9;
    ternary r3 r7.val r8.val into r10;
    cast r9 r10 into r11 as Optional__EsDmm5O6sv6;
    cast false 0u32 into r12 as Optional__EsDmm5O6sv6;
    is.eq r11 r12 into r13;
    assert.eq r13 true;

constructor:
    assert.eq edition 0u16;
verified: true
status: accepted
{
  "transitions": [
    {
      "id": "au1mz8qsn69yu0ax5wlnsh8msdh4tctl3hwywn52tah22dl28ccs5rqujgh35",
      "program": "test_oob.aleo",
      "function": "oob_get",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "2798125274097804511917101139324278513319905945650410939296060523838965832680field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_get,\n  arguments: []\n}"
        }
      ],
      "tpk": "1740771772498913959407600371106966263006430885411593154385073520591007059029group",
      "tcm": "6550523740707201734614700193004479909038263842033341050149036594708317654657field",
      "scm": "558502369377568076060918789132861067687769089370104924073102859390664510584field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

verified: true
status: rejected
{
  "transitions": [
    {
      "id": "au14927mg9au3fkg7ahxg2gtajh3gm3d4425rjzyd9g0te2pqglzy8s5tuyn3",
      "program": "test_oob.aleo",
      "function": "oob_set",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "4257587223585889454443363720153608960905125021151806366827262970667019914766field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_set,\n  arguments: []\n}"
        }
      ],
      "tpk": "178114009707818366893181898372351944028660491837169708739088889836029234072group",
      "tcm": "4739130709009453352579298186510824381132784730088153224770231296914201028590field",
      "scm": "3065639423083373620107719777177180881928628284672801688777444256142195283041field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

verified: true
status: rejected
{
  "transitions": [
    {
      "id": "au1tcpdnjmhhj39yu7vgmy6st3l9swya008cs90nduaxvx3ergqvuqq6q9sw0",
      "program": "test_oob.aleo",
      "function": "oob_swap_remove",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "6036164374720973988287567560522162500584050951852053794735089572416473815069field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_swap_remove,\n  arguments: []\n}"
        }
      ],
      "tpk": "2519928653840182681878343993533780814481409668626446739591416011257472010743group",
      "tcm": "348505252690810815154209238104201566886241984251216933995653793536714566893field",
      "scm": "5005071840512295206585371131488647442393889033168997910259169270792082882664field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

verified: true
status: accepted
{
  "transitions": [
    {
      "id": "au1mwvhq5lwwqscuknn22tu3ljkqkqnv382lcelkyp879fvl73cm5xqe2ftpn",
      "program": "test_oob.aleo",
      "function": "oob_pop",
      "inputs": [],
      "outputs": [
        {
          "type": "future",
          "id": "2425330740985449145377010241254976916263123005557782196394535382014724701753field",
          "value": "{\n  program_id: test_oob.aleo,\n  function_name: oob_pop,\n  arguments: []\n}"
        }
      ],
      "tpk": "7872542197820223462529005432807692380559822313869838022430645650361068187852group",
      "tcm": "4608951870071589430563534390882942254537794451453878900875845207923025872889field",
      "scm": "7770611440689129602448870334775710571406755953189885352916181134201041454683field"
    }
  ],
  "global_state_root": "sr1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq6gk0xu"
}

